<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giriş Sistemi - Yakında</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .container { background: #fff; padding: 2rem; border-radius: 12px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); width: 350px; text-align: center; }
        h2 { margin-top: 0; color: #1c1e21; }
        input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #0866ff; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: bold; margin-top: 10px; }
        button:hover { background: #0055d4; }
        .logout-btn { background: #dc3545; }
        .msg { margin: 10px 0; padding: 10px; border-radius: 4px; font-size: 13px; display: none; }
        .error { display: block; background: #ffebe8; color: #d0342c; }
        .success { display: block; background: #e7f3ff; color: #0866ff; }
        .link { color: #0866ff; cursor: pointer; font-size: 14px; margin-top: 15px; display: inline-block; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

<div class="container">
    <div id="info-msg" class="msg"></div>

    <div id="login-box">
        <h2>Giriş Yap</h2>
        <input type="email" id="l-email" placeholder="E-posta">
        <input type="password" id="l-pass" placeholder="Şifre">
        <button id="btn-login">Giriş</button>
        <span class="link" id="btn-reset">Şifremi Unuttum</span><br>
        <span class="link" onclick="toggleView(false)">Hesabınız yok mu? Kaydol</span>
    </div>

    <div id="reg-box" class="hidden">
        <h2>Kaydol</h2>
        <input type="email" id="r-email" placeholder="E-posta">
        <input type="password" id="r-pass" placeholder="Şifre (Min 6 karakter)">
        <button id="btn-reg">Hesap Oluştur</button>
        <span class="link" onclick="toggleView(true)">Zaten hesabınız var mı? Giriş Yap</span>
    </div>

    <div id="dash-box" class="hidden">
        <h1 style="color:#0866ff">Çok Yakında!</h1>
        <p>Uygulamamız geliştirme aşamasındadır.</p>
        <button id="btn-logout" class="logout-btn">Çıkış Yap</button>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendEmailVerification, sendPasswordResetEmail, onAuthStateChanged, signOut } 
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDky0jC4vlRZ66D10kp8GEXXryymaPFY2Q",
        authDomain: "berks-47dbc.firebaseapp.com",
        projectId: "berks-47dbc",
        storageBucket: "berks-47dbc.firebasestorage.app",
        messagingSenderId: "384612310366",
        appId: "1:384612310366:web:6fe0e771f389782270c3cf",
        measurementId: "G-FBYH92LHQ4"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const msgBox = document.getElementById('info-msg');

    function showMsg(txt, err = true) {
        msgBox.textContent = txt;
        msgBox.className = err ? "msg error" : "msg success";
        msgBox.style.display = "block";
    }

    window.toggleView = (isLogin) => {
        document.getElementById('login-box').classList.toggle('hidden', !isLogin);
        document.getElementById('reg-box').classList.toggle('hidden', isLogin);
        msgBox.style.display = "none";
    };

    // Durum Takibi
    onAuthStateChanged(auth, (user) => {
        if (user && user.emailVerified) {
            document.getElementById('login-box').classList.add('hidden');
            document.getElementById('reg-box').classList.add('hidden');
            document.getElementById('dash-box').classList.remove('hidden');
        } else {
            document.getElementById('dash-box').classList.add('hidden');
            document.getElementById('login-box').classList.remove('hidden');
        }
    });

    // Kayıt
    document.getElementById('btn-reg').onclick = async () => {
        try {
            const res = await createUserWithEmailAndPassword(auth, document.getElementById('r-email').value, document.getElementById('r-pass').value);
            await sendEmailVerification(res.user);
            showMsg("Doğrulama e-postası gönderildi!", false);
        } catch (e) { showMsg("Hata: " + e.message); }
    };

    // Giriş
    document.getElementById('btn-login').onclick = async () => {
        try {
            const res = await signInWithEmailAndPassword(auth, document.getElementById('l-email').value, document.getElementById('l-pass').value);
            if (!res.user.emailVerified) {
                showMsg("Lütfen e-postanızı onaylayın.");
                await signOut(auth);
            }
        } catch (e) { showMsg("Giriş başarısız."); }
    };

    // Şifre Sıfırla
    document.getElementById('btn-reset').onclick = async () => {
        const email = document.getElementById('l-email').value;
        if(!email) return showMsg("E-posta alanını doldurun.");
        try {
            await sendPasswordResetEmail(auth, email);
            showMsg("Sıfırlama linki gönderildi.", false);
        } catch (e) { showMsg("Hata oluştu."); }
    };

    // Çıkış
    document.getElementById('btn-logout').onclick = () => signOut(auth);

</script>
</body>
</html>
